mutate(epiyear=epiyear(`Collection date`),
epiweek=epiweek(`Collection date`))%>%
filter(epiyear>=2022) %>%
filter(!(epiyear==2022 & epiweek<11)) %>%
group_by(State) %>%
summarise(percentage=n()/ nrow(Lineage)*100) %>%
ungroup()
line<- teste %>%
mutate(epiyear=epiyear(`Collection date`),
epiweek=epiweek(`Collection date`))%>%
filter(epiyear>=2022) %>%
filter(!(epiyear==2022 & epiweek<11)) %>%
group_by(State, Lineage) %>%
summarise(total=n()) %>%
ungroup()%>%
group_by(State, Lineage) %>%
mutate(per =  100 *total/sum(total)) %>%
ungroup()
View(line)
line<- teste %>%
mutate(epiyear=epiyear(`Collection date`),
epiweek=epiweek(`Collection date`))%>%
filter(epiyear>=2022) %>%
filter(!(epiyear==2022 & epiweek<11)) %>%
group_by(State, Lineage) %>%
summarise(total=n()) %>%
ungroup()%>%
group_by(State) %>%
mutate(per =  100 *total/sum(total)) %>%
ungroup()
line<- teste %>%
mutate(epiyear=epiyear(`Collection date`),
epiweek=epiweek(`Collection date`))%>%
filter(epiyear>=2022) %>%
filter(!(epiyear==2022 & epiweek<11)) %>%
filter(!is.na(Lineage))%>%
group_by(State, Lineage) %>%
summarise(total=n()) %>%
ungroup()%>%
group_by(State) %>%
mutate(per =  100 *total/sum(total)) %>%
ungroup()
# Getting file names
files <- list.files( pattern="hcov", full.names=TRUE)
library(stringi)
dados <- lapply(files, function(f) {
vroom::vroom(f)}) %>%
bind_rows(.id = "a")
teste<- dados %>%
separate(col = Location,
into = c("Continent", "Country", "State", "Municipality"),
sep = "/",
remove = TRUE # Set to TRUE to remove the original column
) %>%
mutate(
State = str_trim(State),
State = str_squish(State)
) %>%
mutate(estado=
case_when(
State %in% c("Distrito Federal", "Federal District") ~ "Distrito Federal",
State %in%  c("RJ", "Rio de Janeiro") ~ "Rio de Janeiro",
State %in% c("RN", "Rio Grande do Norte") ~ "Rio Grande do Norte",
TRUE ~ State))
line<- teste %>%
mutate(epiyear=epiyear(`Collection date`),
epiweek=epiweek(`Collection date`))%>%
filter(epiyear>=2022) %>%
filter(!(epiyear==2022 & epiweek<11)) %>%
filter(!is.na(Lineage))%>%
group_by(State, Lineage) %>%
summarise(total=n()) %>%
ungroup()%>%
group_by(State) %>%
mutate(per =  100 *total/sum(total)) %>%
ungroup()
line<- teste %>%
mutate(epiyear=epiyear(`Collection date`),
epiweek=epiweek(`Collection date`))%>%
filter(epiyear>=2022) %>%
filter(!(epiyear==2022 & epiweek<11)) %>%
filter(!is.na(Lineage))%>%
group_by(estado, Lineage) %>%
summarise(total=n()) %>%
ungroup()%>%
group_by(estado) %>%
mutate(per =  100 *total/sum(total)) %>%
ungroup()
summarise(line$per, line$estado)
summarise(line$total)
summary(line$total)
summary(line$per)
teste<- line %>%
filter(estado=="Amazonas")
View(teste)
length(unique(dados$Lineage))
line<- teste %>%
mutate(epiyear=epiyear(`Collection date`),
epiweek=epiweek(`Collection date`))%>%
filter(epiyear>=2022) %>%
filter(!(epiyear==2022 & epiweek<11))
line<- teste %>%
mutate(epiyear=epiyear(`Collection date`),
epiweek=epiweek(`Collection date`))%>%
filter(epiyear>=2022) %>%
filter(!(epiyear==2022 & epiweek<11))
teste<- dados %>%
separate(col = Location,
into = c("Continent", "Country", "State", "Municipality"),
sep = "/",
remove = TRUE # Set to TRUE to remove the original column
) %>%
mutate(
State = str_trim(State),
State = str_squish(State)
) %>%
mutate(estado=
case_when(
State %in% c("Distrito Federal", "Federal District") ~ "Distrito Federal",
State %in%  c("RJ", "Rio de Janeiro") ~ "Rio de Janeiro",
State %in% c("RN", "Rio Grande do Norte") ~ "Rio Grande do Norte",
TRUE ~ State))
line<- teste %>%
mutate(epiyear=epiyear(`Collection date`),
epiweek=epiweek(`Collection date`))%>%
filter(epiyear>=2022) %>%
filter(!(epiyear==2022 & epiweek<11))
length(unique(line$Lineage))
linhagens<- unique(line$Lineage)
linhagens
linhagens<- arrange(unique(line$Lineage))
linhagens<- sort(unique(line$Lineage))
linhagens
write.csv2(linhagens, "linhagens_2022,csv", row.names = FALSE)
write.csv2(linhagens, "linhagens_2022.csv", row.names = FALSE)
line<- teste %>%
mutate(epiyear=epiyear(`Collection date`),
epiweek=epiweek(`Collection date`))%>%
filter(epiyear>=2022) %>%
filter(!(epiyear==2022 & epiweek<11))
line<- teste %>%
mutate(epiyear=epiyear(`Collection date`),
epiweek=epiweek(`Collection date`))%>%
filter(epiyear>=2022) %>%
filter(!(epiyear==2022 & epiweek<11)) % >%
group_by(Lineage)%>%
summarise(n=n()) %>%
sort(Lineage)
line<- teste %>%
mutate(epiyear=epiyear(`Collection date`),
epiweek=epiweek(`Collection date`))%>%
filter(epiyear>=2022) %>%
filter(!(epiyear==2022 & epiweek<11)) % >%
group_by(Lineage)%>%
summarise(n=n()) %>%
sort(Lineage)
line<- teste %>%
mutate(epiyear=epiyear(`Collection date`),
epiweek=epiweek(`Collection date`))%>%
filter(epiyear>=2022) %>%
filter(!(epiyear==2022 & epiweek<11)) % >%
group_by(Lineage)%>%
summarise(n=n())
line<- teste %>%
mutate(epiyear=epiyear(`Collection date`),
epiweek=epiweek(`Collection date`))%>%
filter(epiyear>=2022) %>%
filter(!(epiyear==2022 & epiweek<11)) % >%
group_by(Lineage)%>%
summarise(n=n())
line<- teste %>%
mutate(epiyear=epiyear(`Collection date`),
epiweek=epiweek(`Collection date`))%>%
filter(epiyear>=2022) %>%
filter(!(epiyear==2022 & epiweek<11)) %>%
group_by(Lineage)%>%
summarise(n=n()) %>%
sort(Lineage)
line<- teste %>%
mutate(epiyear=epiyear(`Collection date`),
epiweek=epiweek(`Collection date`))%>%
filter(epiyear>=2022) %>%
filter(!(epiyear==2022 & epiweek<11)) %>%
group_by(Lineage)%>%
summarise(n=n()) %>%
sort(Lineage)
line<- teste %>%
mutate(epiyear=epiyear(`Collection date`),
epiweek=epiweek(`Collection date`))%>%
filter(epiyear>=2022) %>%
filter(!(epiyear==2022 & epiweek<11)) %>%
group_by(Lineage)%>%
summarise(n=n()) %>%
sort(Lineage)
line<- teste %>%
mutate(epiyear=epiyear(`Collection date`),
epiweek=epiweek(`Collection date`))%>%
filter(epiyear>=2022) %>%
filter(!(epiyear==2022 & epiweek<11)) %>%
group_by(Lineage)%>%
summarise(n=n())
View(line)
line<- teste %>%
mutate(epiyear=epiyear(`Collection date`),
epiweek=epiweek(`Collection date`))%>%
filter(epiyear>=2022) %>%
filter(!(epiyear==2022 & epiweek<11)) %>%
group_by(Lineage)%>%
summarise(n=n()) %>%
sort(Lineage)
line<- teste %>%
mutate(epiyear=epiyear(`Collection date`),
epiweek=epiweek(`Collection date`))%>%
filter(epiyear>=2022) %>%
filter(!(epiyear==2022 & epiweek<11)) %>%
group_by(Lineage)%>%
summarise(n=n()) %>%
arrange(Lineage)
line<- teste %>%
mutate(epiyear=epiyear(`Collection date`),
epiweek=epiweek(`Collection date`))%>%
filter(epiyear>=2022) %>%
#filter(!(epiyear==2022 & epiweek<11)) %>%
group_by(Lineage)%>%
summarise(n=n()) %>%
arrange(Lineage)
write.csv2(liNE, "linhagens_2022.csv", row.names = FALSE)
write.csv2(line, "linhagens_2022.csv", row.names = FALSE)
library(geobr)
library(tidyr)
library(dplyr)
library(tidyverse)
library(vroom)
library(mem)
library(readxl)
library(zoo)
library(Hmisc)
require(geofacet)
library(cartography)
br<-read_state()
# Getting file names
files <- list.files( pattern="hcov", full.names=TRUE)
library(stringi)
dados <- lapply(files, function(f) {
vroom::vroom(f)}) %>%
bind_rows(.id = "a")
View(dados)
setwd("C:/Users/tatty/Documents/00_FIOCRUZ/infogripe")
path_tendencia = "Dados/InfoGripe/estados_e_pais_serie_estimativas_tendencia_sem_filtro_febre.csv"
dados_tendencia <- import(path_tendencia, dec = ",")
library(rio)
library(lubridate)
dados_tendencia <- import(path_tendencia, dec = ",")
df_uf_crescimento <- dados_tendencia |>
janitor::clean_names() |>
mutate(
casos_estimados = as.numeric(casos_estimados)
) |>
filter(
ds_uf_sigla != "BR",
ano_epidemiologico == year(Sys.Date()),
semana_epidemiologica == isoweek(Sys.Date()) - 1,
escala == "incidência",
# tendencia_de_longo_prazo >= 0.5
) |>
select(
casos_estimados, tendencia_de_longo_prazo, co_uf, ds_uf_sigla, semana_epidemiologica, ano_epidemiologico, escala
)
df_uf_crescimento |>
arrange(ds_uf_sigla) |>
pull(ds_uf_sigla) |>
knitr::combine_words(and = " e ")
View(df_uf_crescimento)
path = "Dados/InfoGripe/casos_semanais_fx_etaria_virus_sem_filtro_febre.csv"
dados <- vroom(file = path)
path_obt = "Dados/InfoGripe/obitos_semanais_fx_etaria_virus_sem_filtro_febre.csv"
dados_obt <- vroom(file = path_obt)
dt_srag <- dados %>% filter(DS_UF_SIGLA==input$selected_state) %>%
filter(epiyear==2025, fx_etaria==input$selected_age)
dt_obt <- dados_obt %>% filter(DS_UF_SIGLA==input$selected_state) %>%
filter(epiyear==2025, fx_etaria==input$selected_age)
dt_srag <- dados %>% filter(DS_UF_SIGLA==input$selected_state) %>%
filter(epiyear==2025, fx_etaria=="Total")
dt_srag <- dados %>% filter(DS_UF_SIGLA=="BR") %>%
filter(epiyear==2025, fx_etaria=="Total")
dt_obt <- dados_obt %>% filter(DS_UF_SIGLA=="BR") %>%
filter(epiyear==2025, fx_etaria=="Total")
max_week<-max(dt_srag$epiweek)-4
tabela_srag<- dt_srag %>%
filter(epiyear=="2025") %>%
summarise("SRAG (n)"=sum(SRAG, na.rm = TRUE),
Positivos=sum(positivos, na.rm = TRUE),
"Positivos (n)"=sum(positivos, na.rm = TRUE),
"Flu A %"=round((sum(FLU_A, na.rm = TRUE)*100)/Positivos,1),
"Flu_B %"=round((sum(FLU_B, na.rm = TRUE)*100)/Positivos,1),
"Covid-19 %"=round(sum(SARS2, na.rm = TRUE)*100/Positivos,1),
"VSR %"=round((sum(VSR, na.rm = TRUE)*100)/Positivos,1),
"Rino %"=round((sum(RINO, na.rm=TRUE)*100)/Positivos,1),
"Aden %"=round((sum(ADNO, na.rm=TRUE)*100)/Positivos,1),
"Meta %"=round((sum(METAP, na.rm=TRUE)*100)/Positivos,1),
"Boca %"=round((sum(BOCA, na.rm=TRUE)*100)/Positivos,1),
"Paraflu %"=round((sum(PARA1, PARA2, PARA3, PARA4, na.rm = TRUE)*100)/Positivos,1)) %>%
mutate(Período="2025", .before = "SRAG (n)") %>%
mutate(Dados="Casos", .before = "Período") %>%
select(!Positivos)
tabela_srag_4semanas<- dt_srag %>%
filter(epiweek>max_week) %>%
summarise("SRAG (n)"=sum(SRAG, na.rm = TRUE),
Positivos=sum(positivos, na.rm = TRUE),
"Positivos (n)"=sum(positivos, na.rm = TRUE),
"Flu A %"=round((sum(FLU_A, na.rm = TRUE)*100)/Positivos,1),
"Flu_B %"=round((sum(FLU_B, na.rm = TRUE)*100)/Positivos,1),
"Covid-19 %"=round(sum(SARS2, na.rm = TRUE)*100/Positivos,1),
"VSR %"=round((sum(VSR, na.rm = TRUE)*100)/Positivos,1),
"Rino %"=round((sum(RINO, na.rm=TRUE)*100)/Positivos,1),
"Aden %"=round((sum(ADNO, na.rm=TRUE)*100)/Positivos,1),
"Meta %"=round((sum(METAP, na.rm=TRUE)*100)/Positivos,1),
"Boca %"=round((sum(BOCA, na.rm=TRUE)*100)/Positivos,1),
"Paraflu %"=round((sum(PARA1, PARA2, PARA3, PARA4, na.rm = TRUE)*100)/Positivos,1),
) %>% mutate(Período="4 semanas", .before = "SRAG (n)") %>%
mutate(Dados="Casos", .before = "Período") %>%
select(!Positivos)
tabela_srag_obt<- dt_obt %>%
filter(epiyear=="2025") %>%
summarise("SRAG (n)"=sum(SRAG, na.rm = TRUE),
Positivos=sum(positivos, na.rm = TRUE),
"Positivos (n)"=sum(positivos, na.rm = TRUE),
"Flu A %"=round((sum(FLU_A, na.rm = TRUE)*100)/Positivos,1),
"Flu_B %"=round((sum(FLU_B, na.rm = TRUE)*100)/Positivos,1),
"Covid-19 %"=round(sum(SARS2, na.rm = TRUE)*100/Positivos,1),
"VSR %"=round((sum(VSR, na.rm = TRUE)*100)/Positivos,1),
"Rino %"=round((sum(RINO, na.rm=TRUE)*100)/Positivos,1),
"Aden %"=round((sum(ADNO, na.rm=TRUE)*100)/Positivos,1),
"Meta %"=round((sum(METAP, na.rm=TRUE)*100)/Positivos,1),
"Boca %"=round((sum(BOCA, na.rm=TRUE)*100)/Positivos,1),
"Paraflu %"=round((sum(PARA1, PARA2, PARA3, PARA4, na.rm = TRUE)*100)/Positivos,1)) %>%
mutate(Período="2025", .before = "SRAG (n)") %>%
mutate(Dados="Óbitos", .before = "Período") %>%
select(!Positivos)
tabela_srag_4semanas_obt<- dt_obt %>%
filter(epiweek>max_week) %>%
summarise("SRAG (n)"=sum(SRAG, na.rm = TRUE),
Positivos=sum(positivos, na.rm = TRUE),
"Positivos (n)"=sum(positivos, na.rm = TRUE),
"Flu A %"=round((sum(FLU_A, na.rm = TRUE)*100)/Positivos,1),
"Flu_B %"=round((sum(FLU_B, na.rm = TRUE)*100)/Positivos,1),
"Covid-19 %"=round(sum(SARS2, na.rm = TRUE)*100/Positivos,1),
"VSR %"=round((sum(VSR, na.rm = TRUE)*100)/Positivos,1),
"Rino %"=round((sum(RINO, na.rm=TRUE)*100)/Positivos,1),
"Aden %"=round((sum(ADNO, na.rm=TRUE)*100)/Positivos,1),
"Meta %"=round((sum(METAP, na.rm=TRUE)*100)/Positivos,1),
"Boca %"=round((sum(BOCA, na.rm=TRUE)*100)/Positivos,1),
"Paraflu %"=round((sum(PARA1, PARA2, PARA3, PARA4, na.rm = TRUE)*100)/Positivos,1)) %>%
mutate(Período="4 semanas", .before = "SRAG (n)") %>%
mutate(Dados="Óbitos", .before = "Período") %>%
select(!Positivos)
View(tabela_srag)
casos_total_srag <- format(df_casos$srag, big.mark = ".", decimal.mark = ",")
casos_total_positivos <- format(df_casos$positivos, big.mark = ".", decimal.mark = ",")
casos_total_positivos_perc <- format(round(100 * df_casos$positivos / df_casos$srag, 1),
big.mark = ".", decimal.mark = ",")
casos_total_negativos <- format(df_casos$negativos, big.mark = ".", decimal.mark = ",")
casos_total_negativos_perc <- format(round(100 * df_casos$negativos / df_casos$srag, 1),
big.mark = ".", decimal.mark = ",")
dados_casos <- dados %>%
clean_names() %>%
filter(ds_uf_sigla == "BR",
fx_etaria == "Total",
ano_epidemiologico == year(Sys.Date()))
dados_casos <- dados %>%
#clean_names() %>%
filter(ds_uf_sigla == "BR",
fx_etaria == "Total",
ano_epidemiologico == year(Sys.Date()))
library(shiny)
library(stringi)
library(tidyverse)
library(vroom)
library(janitor)
library(rio)
library(knitr)
dados_casos <- dados %>%
clean_names() %>%
filter(DS_UF_SIGLA == "BR",
fx_etaria == "Total",
ano_epidemiologico == year(Sys.Date()))
dados_casos <- dados %>%
#clean_names() %>%
filter(DS_UF_SIGLA == "BR",
fx_etaria == "Total",
ano_epidemiologico == year(Sys.Date()))
dados_casos <- dados %>%
#clean_names() %>%
filter(DS_UF_SIGLA == "BR",
fx_etaria == "Total",
epiyear == year(Sys.Date()))
df_casos <- dados_casos %>%
summarise(across(c(srag:aguardando), ~sum(.)))
df_casos <- dados_casos %>%
summarise(across(c(SRAG:aguardando), ~sum(.)))
df_casos_4sem <- dados_casos %>%
filter(epiweek >= isoweek(Sys.Date()) - 4,
epiweek <= isoweek(Sys.Date()) - 1) %>%
summarise(across(c(SRAG:aguardando), ~sum(.)))
casos_total_srag <- format(df_casos$srag, big.mark = ".", decimal.mark = ",")
format(df_casos$srag, big.mark = ".", decimal.mark = ",")
format(df_casos$srag, big.mark = ".", decimal.mark = ",")
casos_total_positivos <- format(df_casos$positivos, big.mark = ".", decimal.mark = ",")
casos_total_positivos_perc <- format(round(100 * df_casos$positivos / df_casos$srag, 1),
big.mark = ".", decimal.mark = ",")
casos_total_srag <- format(df_casos$SRAG, big.mark = ".", decimal.mark = ",")
casos_total_positivos <- format(df_casos$positivos, big.mark = ".", decimal.mark = ",")
casos_total_positivos_perc <- format(round(100 * df_casos$positivos / df_casos$SRAG, 1),
big.mark = ".", decimal.mark = ",")
casos_total_negativos <- format(df_casos$negativos, big.mark = ".", decimal.mark = ",")
casos_total_negativos_perc <- format(round(100 * df_casos$negativos / df_casos$SRAG, 1),
big.mark = ".", decimal.mark = ",")
casos_total_aguardando <- format(df_casos$aguardando, big.mark = ".", decimal.mark = ",")
casos_total_aguardando_perc <- format(round(100 * df_casos$aguardando / df_casos$SRAG, 1),
big.mark = ".", decimal.mark = ",")
format(df_casos$SRAG, big.mark = ".", decimal.mark = ",")
dados_casos <- dados %>%
clean_names() %>%
filter(DS_UF_SIGLA == "BR",
fx_etaria == "Total",
epiyear == year(Sys.Date()))
dados_casos <- dados %>%
clean_names() %>%
filter(DS_UF_SIGLA == "BR",
fx_etaria == "Total",
epiyear == year(Sys.Date()))
dados_casos <- dados %>%
clean_names() %>%
filter(DS_UF_SIGLA == "BR",
fx_etaria == "Total",
epiyear == year(Sys.Date()))
dados_casos <- dados %>%
clean_names()
View(dados_casos)
dados_casos <- dados %>%
clean_names() %>%
filter(ds_uf_sigla == "BR",
fx_etaria == "Total",
epiyear == year(Sys.Date()))
dados_casos <- dados %>%
#clean_names() %>%
filter(DS_UF_SIGLA == "BR",
fx_etaria == "Total",
epiyear == 2025)
df_casos <- dados_casos %>%
summarise(across(c(SRAG:aguardando), ~sum(.)))
df_casos_4sem <- dados_casos %>%
filter(epiweek >= 2025 - 4,
epiweek <= 2025 - 1) %>%
summarise(across(c(SRAG:aguardando), ~sum(.)))
casos_total_srag <- format(df_casos$SRAG, big.mark = ".", decimal.mark = ",")
casos_total_positivos <- format(df_casos$positivos, big.mark = ".", decimal.mark = ",")
casos_total_positivos_perc <- format(round(100 * df_casos$positivos / df_casos$SRAG, 1),
big.mark = ".", decimal.mark = ",")
casos_total_negativos <- format(df_casos$negativos, big.mark = ".", decimal.mark = ",")
casos_total_negativos_perc <- format(round(100 * df_casos$negativos / df_casos$SRAG, 1),
big.mark = ".", decimal.mark = ",")
casos_total_aguardando <- format(df_casos$aguardando, big.mark = ".", decimal.mark = ",")
casos_total_aguardando_perc <- format(round(100 * df_casos$aguardando / df_casos$SRAG, 1),
big.mark = ".", decimal.mark = ",")
casos_total_srag
casos_total_positivos
casos_total_positivos_perc
casos_total_negativo
casos_total_negativos
casos_total_negativos_perc
casos_total_aguardando
casos_total_aguardando_perc
View(tabela_srag)
View(tabela_srag_4semanas)
dados_obitos <- dados_obt %>%
clean_names() %>%
filter(ds_uf_sigla == "BR",
fx_etaria == "Total",
epiyear == 2025)
df_obt <- dados_obitos %>%
summarise(across(c(SRAG:aguardando), ~sum(.)))
df_obt <- dados_obitos %>%
summarise(across(c(srag:aguardando), ~sum(.)))
## Section "SARI Deaths"
# Total, positives and waiting
obitos_total_srag <- format(df_obitos$srag, big.mark = ".", decimal.mark = ",")
df_obitos <- dados_obitos %>%
summarise(across(c(srag:aguardando), ~sum(.)))
## Section "SARI Deaths"
# Total, positives and waiting
obitos_total_srag <- format(df_obitos$srag, big.mark = ".", decimal.mark = ",")
obitos_total_positivos <- format(df_obitos$positivos, big.mark = ".", decimal.mark = ",")
obitos_total_positivos_perc <- format(round(100 * df_obitos$positivos / df_obitos$srag, 1),
big.mark = ".", decimal.mark = ",")
obitos_total_negativos <- format(df_obitos$negativos, big.mark = ".", decimal.mark = ",")
obitos_total_negativos_perc <- format(round(100 * df_obitos$negativos / df_obitos$srag, 1),
big.mark = ".", decimal.mark = ",")
obitos_total_aguardando <- format(df_obitos$aguardando, big.mark = ".", decimal.mark = ",")
obitos_total_aguardando_perc <- format(round(100 * df_obitos$aguardando / df_obitos$srag, 1),
big.mark = ".", decimal.mark = ",")
obitos_total_srag
obitos_total_positivos
obitos_total_positivos_perc
obitos_total_negativos
obitos_total_negativos_perc
obitos_total_aguardando
obitos_total_aguardando_perc
View(tabela_srag_4semanas_obt)
View(tabela_srag_obt)
View(tabela_srag_obt)
View(tabela_srag_4semanas_obt)
